ğŸ§  MarketSeer é¡¹ç›®æ–‡æ¡£

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

MarketSeer æ˜¯ä¸€ä¸ªé‡‘èæ•°æ®é‡‡é›†ã€æ•´åˆä¸åˆ†æç³»ç»Ÿï¼Œæ—¨åœ¨é€šè¿‡å¤šæ•°æ®æºï¼ˆAkShareã€eFinanceã€yFinance ç­‰ï¼‰è‡ªåŠ¨è·å–è‚¡ç¥¨å¸‚åœºæ•°æ®ï¼Œæ„å»ºç»Ÿä¸€çš„æ•°æ®ä¸­å¿ƒï¼Œä¸ºå‰ç«¯å¯è§†åŒ–ä¸åˆ†ææä¾›æ”¯æŒã€‚

ç³»ç»Ÿé‡‡ç”¨ï¼š

- **åç«¯**ï¼šFlask + SQLAlchemy
- **å‰ç«¯**ï¼šReact (JavaScript)
- **é¡¹ç›®ç®¡ç†å·¥å…·**ï¼šuv (Python ç¯å¢ƒç®¡ç†)
- **æ•°æ®åº“æ“ä½œ**ï¼šSQLAlchemy ORM
- **æ•°æ®åº“æ”¯æŒ**ï¼šSQLiteï¼ˆæœ¬åœ°å¼€å‘ï¼‰/ Supabase PostgreSQLï¼ˆçº¿ä¸Šéƒ¨ç½²ï¼‰
- **è¿è¡Œç¯å¢ƒ**ï¼šæœ¬åœ°å¼€å‘ â†’ æµ‹è¯• â†’ éƒ¨ç½²ç”Ÿäº§

---

## äºŒã€é¡¹ç›®ç»“æ„

```
MarketSeer/
â”‚
â”œâ”€â”€ backend/               # åç«¯æ ¸å¿ƒç›®å½•
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ routes/        # è·¯ç”±æ¥å£
â”‚   â”‚   â”œâ”€â”€ models/        # æ•°æ®åº“æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ services/      # æ•°æ®é‡‡é›†ä¸åˆå¹¶é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ utils/         # å·¥å…·å‡½æ•°ï¼ˆæ—¥å¿—ã€æ—¶é—´ã€æ ¼å¼åŒ–ï¼‰
â”‚   â”‚   â”œâ”€â”€ config.py      # å…¨å±€é…ç½®ï¼ˆAPI Keysã€è·¯å¾„ã€ç¯å¢ƒå˜é‡ï¼‰
â”‚   â”‚   â””â”€â”€ tasks/         # å®šæ—¶ä»»åŠ¡æˆ–æ•°æ®æ›´æ–°è„šæœ¬
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â””â”€â”€ marketseer.db  # SQLite æ•°æ®åº“æ–‡ä»¶
â”‚   â”œâ”€â”€ pyproject.toml     # uv é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ uv.lock
â”‚   â”œâ”€â”€ run.py             # åç«¯å¯åŠ¨å…¥å£
â”‚   â””â”€â”€ README.md
â”‚
â””â”€â”€ frontend/              # å‰ç«¯é¡¹ç›®
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ components/
    â”‚   â”œâ”€â”€ pages/
    â”‚   â”œâ”€â”€ services/      # è°ƒç”¨åç«¯ API
    â”‚   â”œâ”€â”€ hooks/
    â”‚   â””â”€â”€ utils/
    â”œâ”€â”€ public/
    â”œâ”€â”€ package.json
    â”œâ”€â”€ vite.config.js
    â””â”€â”€ README.md
```

---

## ä¸‰ã€æ•°æ®åº“è®¾è®¡

### 1. è®¾è®¡è¯´æ˜

åˆå§‹é˜¶æ®µä»…åŒ…å« `stock_info` ä¸€å¼ è¡¨ï¼Œç”¨äºå­˜å‚¨è‚¡ç¥¨åŸºç¡€ä¿¡æ¯ã€‚  
æ•°æ®æ¥æºäº AkShare ä¸ eFinance çš„æ¥å£æ•´åˆç»“æœã€‚

æœªæ¥ä¼šæ‹“å±•æ›´å¤šè¡¨ï¼š

- `stock_price`
- `stock_financials`
- `stock_dividend`
- `stock_analysis`

### 2. è¡¨ç»“æ„å®šä¹‰

| å­—æ®µå      | ç±»å‹    | è¯´æ˜                                    |
| ----------- | ------- | --------------------------------------- |
| id          | INTEGER | ä¸»é”®ï¼Œè‡ªå¢                              |
| code        | TEXT    | è‚¡ç¥¨ä»£ç ï¼ˆå”¯ä¸€ï¼‰                        |
| name        | TEXT    | è‚¡ç¥¨åç§°                                |
| market      | TEXT    | å¸‚åœºï¼ˆå¦‚ä¸Šäº¤æ‰€ã€æ·±äº¤æ‰€ï¼‰                |
| industry    | TEXT    | è¡Œä¸šåˆ†ç±»                                |
| list_date   | TEXT    | ä¸Šå¸‚æ—¥æœŸ                                |
| status      | TEXT    | å½“å‰çŠ¶æ€ï¼ˆä¸Šå¸‚ / é€€å¸‚ï¼‰                 |
| source      | TEXT    | æ•°æ®æ¥æºï¼ˆakshare / efinance / mergedï¼‰ |
| update_time | TEXT    | æœ€åæ›´æ–°æ—¶é—´ï¼ˆISO æ ¼å¼ï¼‰                |

---

## å››ã€åç«¯æ¥å£è®¾è®¡

### 1. æ¥å£è®¾è®¡åŸåˆ™

- RESTful é£æ ¼
- æ‰€æœ‰æ¥å£ä»¥ `/api/` å¼€å¤´
- æ•°æ®è¿”å›ç»Ÿä¸€æ ¼å¼ï¼š

```json
{
  "status": "success",
  "data": {...},
  "message": ""
}
```

### 2. æ¥å£æ–‡æ¡£æ¨¡æ¿

#### æ¥å£åç§°ï¼šè‚¡ç¥¨åˆ—è¡¨æŸ¥è¯¢

- **è¯·æ±‚æ–¹å¼**ï¼šGET
- **URL**ï¼š`/api/stocks`
- **å‚æ•°**ï¼šæ— ï¼ˆå¯åç»­æ‰©å±•åˆ†é¡µã€ç­›é€‰ï¼‰
- **è¿”å›ç¤ºä¾‹**ï¼š

```json
{
  "status": "success",
  "data": [
    {
      "code": "600519",
      "name": "è´µå·èŒ…å°",
      "market": "SH",
      "industry": "é¥®æ–™åˆ¶é€ ",
      "list_date": "2001-08-27"
    }
  ]
}
```

#### æ¥å£åç§°ï¼šå•åªè‚¡ç¥¨è¯¦æƒ…æŸ¥è¯¢

- **è¯·æ±‚æ–¹å¼**ï¼šGET
- **URL**ï¼š`/api/stocks/<code>`
- **å‚æ•°**ï¼š`code` - è‚¡ç¥¨ä»£ç 
- **è¿”å›ç¤ºä¾‹**ï¼š

```json
{
  "status": "success",
  "data": {
    "code": "600519",
    "name": "è´µå·èŒ…å°",
    "market": "SH",
    "industry": "é¥®æ–™åˆ¶é€ ",
    "list_date": "2001-08-27",
    "status": "ä¸Šå¸‚"
  }
}
```

#### æ¥å£åç§°ï¼šæ•°æ®æ›´æ–°æ¥å£

- **è¯·æ±‚æ–¹å¼**ï¼šPOST
- **URL**ï¼š`/api/update/stocks`
- **è¯´æ˜**ï¼šä» AkShareã€eFinance ç­‰æ•°æ®æºæ›´æ–°æ•°æ®åº“
- **è¿”å›**ï¼š

```json
{
  "status": "success",
  "message": "stock_info updated successfully",
  "updated_rows": 2345
}
```

---

## äº”ã€å‰åç«¯äº¤äº’æµç¨‹

1. ç”¨æˆ·åœ¨å‰ç«¯å‘èµ·è¯·æ±‚ï¼ˆé€šè¿‡ Axiosï¼‰ï¼›
2. Flask åç«¯æ¥æ”¶è¯·æ±‚ï¼›
3. è‹¥ä¸ºæŸ¥è¯¢ç±»æ¥å£ â†’ ä» SQLite è¯»å–ï¼›
4. è‹¥ä¸ºæ›´æ–°ç±»æ¥å£ â†’ è°ƒç”¨ AkShare / eFinance â†’ æ¸…æ´—åˆå¹¶ â†’ å†™å…¥æ•°æ®åº“ï¼›
5. è¿”å› JSON å“åº”ï¼›
6. å‰ç«¯æ¸²æŸ“å±•ç¤ºã€‚

---

## å…­ã€æ•°æ®åº“é…ç½®

MarketSeer æ”¯æŒä¸¤ç§æ•°æ®åº“æ¨¡å¼ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°çµæ´»åˆ‡æ¢ï¼š

### 1. SQLite æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼šæœ¬åœ°å¼€å‘ã€æµ‹è¯•ç¯å¢ƒ

**å¯åŠ¨å‘½ä»¤**ï¼š

```bash
cd backend
python run.py
# æˆ–æ˜¾å¼æŒ‡å®š
python run.py --db sqlite
```

**ç‰¹ç‚¹**ï¼š

- æ— éœ€é¢å¤–é…ç½®
- æ•°æ®å­˜å‚¨åœ¨ `backend/data/marketseer.db`
- è‡ªåŠ¨åˆ›å»ºæ•°æ®ç›®å½•å’Œæ•°æ®åº“æ–‡ä»¶
- é€‚åˆå•æœºå¼€å‘å’Œå¿«é€Ÿæµ‹è¯•

### 2. Supabase æ¨¡å¼

**é€‚ç”¨åœºæ™¯**ï¼šçº¿ä¸Šéƒ¨ç½²ã€å¤šäººåä½œã€äº‘ç«¯æ•°æ®ç®¡ç†

**é…ç½®æ­¥éª¤**ï¼š

1. å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿ï¼š

```bash
cd backend
cp .env.example .env
```

2. ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥ Supabase æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼š

```bash
SUPABASE_DATABASE_URI=postgresql://postgres.[é¡¹ç›®å¼•ç”¨]:[å¯†ç ]@aws-[åŒºåŸŸ].pooler.supabase.com:6543/postgres
```

3. å¯åŠ¨å‘½ä»¤ï¼š

```bash
python run.py --db supabase
```

**æ³¨æ„äº‹é¡¹**ï¼š

- ç¡®ä¿ Supabase é¡¹ç›®å·²åˆ›å»ºå¹¶è·å–æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
- æ•°æ®åº“å¯†ç ä¸èƒ½åŒ…å«æ–¹æ‹¬å· `[]` ç­‰ç‰¹æ®Šå­—ç¬¦
- é¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨åˆ›å»ºè¡¨ç»“æ„
- è¯¦ç»†é…ç½®è¯´æ˜è¯·å‚è€ƒ `backend/.env.example`

### 3. æ•°æ®åº“åˆ‡æ¢è¯´æ˜

- ä¸¤ç§æ•°æ®åº“æ¨¡å¼**äº’ä¸å½±å“**ï¼Œå¯ä»¥éšæ—¶åˆ‡æ¢
- ä½¿ç”¨ SQLAlchemy ORMï¼Œä¸šåŠ¡ä»£ç æ— éœ€ä¿®æ”¹
- åˆ‡æ¢æ•°æ®åº“æ—¶æ³¨æ„æ•°æ®è¿ç§»éœ€æ±‚

---

## ä¸ƒã€è¿è¡Œé¡¹ç›®

### 1. å¯åŠ¨åç«¯

**SQLite æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰**ï¼š

```bash
cd backend
uv venv
uv pip install -e .
python run.py
```

**Supabase æ¨¡å¼**ï¼š

```bash
cd backend
uv venv
uv pip install -e .
# ç¡®ä¿å·²é…ç½® .env æ–‡ä»¶
python run.py --db supabase
```

### 2. å¯åŠ¨å‰ç«¯

```bash
cd frontend
npm install
npm run dev
```

å‰ç«¯æœåŠ¡å°†åœ¨ http://localhost:3000 å¯åŠ¨  
åç«¯æœåŠ¡å°†åœ¨ http://localhost:5000 å¯åŠ¨

---

## å…«ã€è®¸å¯è¯

MIT License
